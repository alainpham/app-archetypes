FROM eclipse-temurin:${temurin-image-version}

USER root

RUN useradd -u 1000 appuser

WORKDIR /deployments

RUN curl https://repo1.maven.org/maven2/io/fabric8/run-java-sh/${RUN_JAVA_VERSION}/run-java-sh-${RUN_JAVA_VERSION}-sh.sh -o /deployments/run-java.sh \
    && chown 1000 /deployments/run-java.sh \
    && chmod 550 /deployments/run-java.sh

USER 1000

COPY target/*.jar /deployments/

EXPOSE 8080

ENTRYPOINT [ "/deployments/run-java.sh" ]
